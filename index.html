<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pendaftaran Kursus</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 20px; }
    .container { max-width: 700px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ccc; }
    button { padding: 10px 20px; background: #005f73; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0a9396; }
    .kursus-list input { margin-bottom: 10px; }
  </style>
</head>
<body>

<div class="container">
  <h2>Pendaftaran Kursus Sesi 2025/2026(1)</h2>
  <form id="daftarForm">
    <input type="text" name="nama" placeholder="Nama Pelajar" required>
    <input type="text" name="matrik" placeholder="No Matriks" required>
    <input type="text" name="nokp" placeholder="No Kad Pengenalan" required>
    <input type="tel" name="notel" placeholder="No Telefon" required pattern="[0-9]{10,12}">
    <input type="email" name="emel" placeholder="Alamat Emel" required>
    <textarea name="alamat" placeholder="Alamat Rumah" required></textarea>

    <label><strong>Kursus Yang Didaftarkan</strong></label>
    <div id="kursusContainer" class="kursus-list">
      <input type="text" name="kursus[]" placeholder="Kod & Nama Kursus 1" required>
    </div>
    <button type="button" onclick="tambahKursus()">+ Tambah Kursus</button>

    <br><br>
    <button type="submit">Hantar Pendaftaran</button>
    <p id="status"></p>
  </form>
</div>
  
<!-- Tambah di dalam <body> seperti sebelum ini -->
<div id="paparanSemula" style="display:none; background:#e0f7fa; padding:20px; margin-top:30px; border-radius:10px;">
  <h3>Pengesahan Pendaftaran</h3>
  <p><strong>Nama:</strong> <span id="outNama"></span></p>
  <p><strong>No Matriks:</strong> <span id="outMatrik"></span></p>
  <p><strong>No KP:</strong> <span id="outNoKP"></span></p>
  <p><strong>No Tel:</strong> <span id="outNoTel"></span></p>
  <p><strong>Emel:</strong> <span id="outEmel"></span></p>
  <p><strong>Alamat:</strong> <span id="outAlamat"></span></p>
  <p><strong>Kursus Didaftarkan:</strong>
    <ul id="outKursus"></ul>
  </p>
</div>

<script>
let kursusCount = 1;
const maxKursus = 5;

function tambahKursus() {
  if (kursusCount >= maxKursus) return alert("Maksimum 5 kursus sahaja.");
  const container = document.getElementById("kursusContainer");
  const input = document.createElement("input");
  input.type = "text";
  input.name = "kursus[]";
  input.placeholder = `Kod & Nama Kursus ${kursusCount + 1}`;
  container.appendChild(input);
  kursusCount++;
}

document.getElementById("daftarForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const form = e.target;
  const data = {
    nama: form.nama.value,
    matrik: form.matrik.value,
    nokp: form.nokp.value,
    notel: form.notel.value,
    emel: form.emel.value,
    alamat: form.alamat.value,
    kursus: Array.from(form.querySelectorAll('input[name="kursus[]"]')).map(i => i.value).slice(0, 5)
  };

  // Gantikan URL berikut dengan URL sebenar dari Google Apps Script anda
  const scriptURL = "https://script.google.com/macros/s/AKfycbzJJmNgpvl2iW1qYTTDjEUaltoi9uaOB77s15vm5YSs-cf1257w8ZkFT7xzgwi0KpOv/exec";
                     
 fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(response => {
    document.getElementById("status").innerText = "Sedang menghantar...";
    document.getElementById("status").innerText = "Pendaftaran berjaya dihantar!";
    form.reset();
    kursusCount = 1;
    document.getElementById("kursusContainer").innerHTML = '<input type="text" name="kursus[]" placeholder="Kod & Nama Kursus 1" required>';

    // Papar semula data
    document.getElementById("outNama").innerText = response.nama;
    document.getElementById("outMatrik").innerText = response.matrik;
    document.getElementById("outNoKP").innerText = response.nokp;
    document.getElementById("outNoTel").innerText = response.notel;
    document.getElementById("outEmel").innerText = response.emel;
    document.getElementById("outAlamat").innerText = response.alamat;

    const kursusList = document.getElementById("outKursus");
    kursusList.innerHTML = "";
    response.kursus.forEach(k => {
      if (k.trim() !== "") {
        const li = document.createElement("li");
        li.innerText = k;
        kursusList.appendChild(li);
      }
    });

    document.getElementById("paparanSemula").style.display = "block";
  })
  .catch(error => {
    document.getElementById("status").innerText = "Ralat semasa menghantar pendaftaran.";
    console.error(error);
  });
});
</script>
</body>
</html>
